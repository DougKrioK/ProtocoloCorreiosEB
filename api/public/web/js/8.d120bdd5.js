(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{b623:function(e,o,t){"use strict";t.r(o);var r=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",[t("bodyTabs",{attrs:{titulo:"Cadastro de Rotas"}},[t("template",{slot:"tabHeader"},[t("q-tab",{attrs:{name:"tab-1",icon:"folder_shared",label:"Cadastro"}}),e.rota.rota&&e.possoAbrirRotaEndereco?t("q-tab",{attrs:{name:"tab-2",icon:"fas fa-map-signs",label:"Endereços"}}):e._e()],1),t("template",{slot:"tabPanel"},[t("q-tab-panel",{attrs:{name:"tab-1"}},[t("form",{on:{submit:function(o){return o.preventDefault(),e.salvarAlterar(o)}}},[t("div",{staticClass:"row barraBotoes"},[t("div",{staticClass:"col-md-6 linhaBotoes"},[e.possoGravarRota?t("q-btn",{attrs:{small:"",type:"reset",icon:"add"},on:{click:e.reset}},[e._v("Novo")]):e._e(),!e.rota.rota&&e.possoGravarRota?t("q-btn",{attrs:{small:"",type:"submit",icon:"save"}},[e._v("Gravar")]):e._e(),e.rota.rota&&e.possoAlterarRota?t("q-btn",{attrs:{small:"",type:"submit",icon:"save"}},[e._v("Alterar")]):e._e(),e.possoExcluirRota?t("q-btn",{attrs:{small:"",type:"button",icon:"delete"},on:{click:e.excluir}},[e._v("Excluir")]):e._e()],1)]),t("q-list",[t("q-expansion-item",{attrs:{label:"Dados Gerais","default-opened":""}},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-md-6"},[t("q-input",{staticClass:"form-input",attrs:{label:"Descrição",hint:"Obrigatório",error:e.$v.rota.descricao.$error,"error-message":e.errorDescricao,autocomplete:"off",type:"text",name:"descricao"},on:{input:function(o){return e.$v.rota.descricao.$touch()}},model:{value:e.rota.descricao,callback:function(o){e.$set(e.rota,"descricao",o)},expression:"rota.descricao"}})],1),t("div",{staticClass:"col-md-3"},[t("q-input",{staticClass:"form-input",attrs:{label:"Código",hint:"Obrigatório",error:e.$v.rota.codigo.$error,"error-message":"Obrigatório",autocomplete:"off",type:"text",name:"codigo"},on:{input:function(o){return e.$v.rota.codigo.$touch()}},model:{value:e.rota.codigo,callback:function(o){e.$set(e.rota,"codigo",o)},expression:"rota.codigo"}})],1),t("div",{staticClass:"col-md-3"},[t("q-field",{staticClass:"form-input",attrs:{label:"Status",borderless:"","stack-label":""}},[t("q-option-group",{attrs:{inline:"",options:[{label:"Ativo",value:1},{label:"Inativo",value:0}],color:"primary"},model:{value:e.rota.status,callback:function(o){e.$set(e.rota,"status",o)},expression:"rota.status"}})],1)],1)])])],1)],1)]),t("q-tab-panel",{attrs:{name:"tab-2"}},[t("form-rota-endereco",{ref:"formRotaEndereco",attrs:{rota:e.rota.rota}})],1)],1)],2),t("lista-de-registros")],1)},a=[],s=(t("f751"),t("bbff")),n=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("lista-de-registros",{ref:"listaDeRegistros",attrs:{labelHeader:"Rotas"},on:{atualizaLista:e.atualizaLista}},[t("template",{slot:"qItem"},e._l(e.getRegistros,(function(o,r){return t("q-item",{key:r,staticClass:"item-lista",class:r%2?"bg-blue-grey-1":"bg-blue-grey-2",attrs:{multiline:"",item:"",to:{name:"alterarRota",params:{id:o.rota}},exact:""}},[t("q-item-section",[t("q-item-label",[e._v(" "+e._s(o.descricao))]),t("q-item-label",{attrs:{caption:""}},[e._v(e._s(o.codigo))])],1)],1)})),1)],2)},i=[],c=(t("8e6e"),t("8a81"),t("ac6a"),t("cadf"),t("06db"),t("456d"),t("9523")),l=t.n(c),u=t("2f62"),d=t("dbcf"),f=t("0da6"),p=(t("6b54"),t("2397"),t("970b")),m=t.n(p),g=t("5bc3"),v=t.n(g),b=t("ed6d"),h=t.n(b),E=t("6b58"),q=t.n(E),R=t("36c6"),y=t.n(R),$=t("5c12");function C(e){var o=w();return function(){var t,r=y()(e);if(o){var a=y()(this).constructor;t=Reflect.construct(r,arguments,a)}else t=r.apply(this,arguments);return q()(this,t)}}function w(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var x=function(e){h()(t,e);var o=C(t);function t(){return m()(this,t),o.apply(this,arguments)}return v()(t,null,[{key:"procura",value:function(e,o,t){return this.get("rotas",{params:{busca:e,inicio:o,fim:t}})}},{key:"lista",value:function(){return this.get("rotas/lista")}},{key:"seleciona",value:function(e){return this.get("rotas/rota/".concat(e))}},{key:"grava",value:function(e){return this.post("rotas/rota",e)}},{key:"altera",value:function(e){return this.put("rotas/rota/".concat(e.rota),e)}},{key:"apaga",value:function(e){return this.delete("rotas/rota/".concat(e))}}]),t}($["a"]),k=x;function O(e,o){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);o&&(r=r.filter((function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable}))),t.push.apply(t,r)}return t}function _(e){for(var o=1;o<arguments.length;o++){var t=null!=arguments[o]?arguments[o]:{};o%2?O(Object(t),!0).forEach((function(o){l()(e,o,t[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):O(Object(t)).forEach((function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(t,o))}))}return e}var A={name:"ListaDeRotas",components:{ListaDeRegistros:f["a"]},data:function(){return{}},computed:_({},Object(u["b"])({getRegistros:"listaDeRegistros/getRegistros"})),methods:{atualizaLista:function(e){d["a"].atualizaLista({service:k,semRegistros:[{descricao:"Sem registros encontrados",codigo:""}],self:this,done:e})}}},D=A,L=t("2877"),S=Object(L["a"])(D,n,i,!1,null,null,null),P=S.exports,j=t("b5ae"),z=t("5c2b"),T=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("q-page",{staticClass:"q-pa-sm full-height"},[t("form",{on:{submit:function(o){return o.preventDefault(),e.salvarAlterar(o)}}},[t("div",{staticClass:"row barraBotoes"},[t("div",{staticClass:"col-md-6 linhaBotoes"},[e.possoGravarRotaEndereco?t("q-btn",{attrs:{small:"",type:"reset",icon:"add"},on:{click:e.reset}},[e._v("Novo")]):e._e(),!e.rotaEndereco.rotaEndereco&&e.possoGravarRotaEndereco?t("q-btn",{attrs:{small:"",type:"submit",icon:"save"}},[e._v("Gravar")]):e._e(),e.rotaEndereco.rotaEndereco&&e.possoAlterarRotaEndereco?t("q-btn",{attrs:{small:"",type:"submit",icon:"save"}},[e._v("Alterar")]):e._e(),e.possoExcluirRotaEndereco?t("q-btn",{attrs:{small:"",type:"button",icon:"delete"},on:{click:e.excluir}},[e._v("Excluir")]):e._e()],1)]),t("q-list",[t("div",{staticClass:"row"},[t("div",{staticClass:"col-md-12"},[t("form-select",{attrs:{classe:"form-input",label:"Endereço",hint:"Obrigatório",error:e.$v.rotaEndereco.endereco.$error,"error-message":"Obrigatório",options:e.optionsEndereco,required:""},model:{value:e.rotaEndereco.endereco,callback:function(o){e.$set(e.rotaEndereco,"endereco",o)},expression:"rotaEndereco.endereco"}}),t("q-linear-progress",{directives:[{name:"show",rawName:"v-show",value:e.optionsLoading,expression:"optionsLoading"}],attrs:{indeterminate:""}})],1)])])],1),t("br"),t("div",[t("q-table",{attrs:{title:"Lista de RotaEnderecos",data:e.listaDeRotaEnderecos,columns:e.tabelaColunas,"row-key":"id",loading:e.carregandoLista,filter:e.buscaRotaEndereco,separator:e.tabelaSeparador,"no-data-label":"Sem registros encontrados","no-results-label":"Sem registros encontrados","rows-per-page-label":"Linhas por página","loading-label":"Carregando","visible-columns":e.colunasVisiveis},scopedSlots:e._u([{key:"top-right",fn:function(o){return[t("q-select",{staticStyle:{"min-width":"150px"},attrs:{multiple:"",borderless:"",dense:"","options-dense":"","display-value":"Colunas","emit-value":"","map-options":"",options:e.tabelaColunas,"option-value":"name"},model:{value:e.colunasVisiveis,callback:function(o){e.colunasVisiveis=o},expression:"colunasVisiveis"}}),t("q-btn",{attrs:{flat:"",round:"",dense:"",icon:o.inFullscreen?"fullscreen_exit":"fullscreen"},on:{click:o.toggleFullscreen}})]}},{key:"body-cell-remover",fn:function(o){return t("q-td",{attrs:{props:o}},[t("q-btn",{attrs:{type:"button",color:"primary",flat:"",round:"",delete:"",icon:"delete"},on:{click:function(t){return e.excluir(o.row.id)}}})],1)}}])})],1)])},G=[],B=t("de64"),N=t("99b66"),V=t("3a60"),F=t("fdde");function U(e){var o=H();return function(){var t,r=y()(e);if(o){var a=y()(this).constructor;t=Reflect.construct(r,arguments,a)}else t=r.apply(this,arguments);return q()(this,t)}}function H(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var I,J=function(e){h()(t,e);var o=U(t);function t(){return m()(this,t),o.apply(this,arguments)}return v()(t,null,[{key:"procura",value:function(e,o,t){return this.get("rotasenderecos",{params:{busca:e,inicio:o,fim:t}})}},{key:"lista",value:function(e){return this.get("rotasenderecos/rota/".concat(e))}},{key:"seleciona",value:function(e){return this.get("rotasenderecos/rota/".concat(e.rota,"/endereco/").concat(e.endereco))}},{key:"grava",value:function(e){return this.post("rotasenderecos/rotaendereco",e)}},{key:"altera",value:function(e){return this.put("rotasenderecos/rota/".concat(e.rota,"/endereco/").concat(e.endereco),e)}},{key:"apaga",value:function(e){return this.delete("rotasenderecos/rotaendereco/".concat(e.rotaEndereco))}},{key:"getOptions",value:function(){return this.get("rotasenderecos/options")}}]),t}($["a"]),K=J,M=t("fe44"),Q=t("77cc"),W={name:"RotaEndereco",components:{formSelect:Q["a"]},directives:{mask:V["mask"]},data:function(){return{buscaRotaEndereco:"",optionsLoading:!1,optionsEndereco:[],endereco:new M["a"],rotaEndereco:new F["a"],botaoSalvarAlterar:"Salvar",carregandoLista:!1,listaDeRotaEnderecos:[],colunasVisiveis:["codigo","descricao","logradouro","uf"],tabelaSeparador:"horizontal",tabelaColunas:[{name:"codigo",required:!0,label:"Código",align:"left",field:"codigo",sortable:!0},{name:"descricao",required:!0,label:"Descrição",align:"left",field:"descricao",sortable:!0},{name:"logradouro",label:"Logradouro",align:"left",field:"logradouro",sortable:!0},{name:"numero",label:"Número",align:"left",field:"numero"},{name:"bairro",label:"Bairro",align:"left",field:"bairro",sortable:!0},{name:"cidade",label:"Cidade",align:"left",field:"cidade",sortable:!0},{name:"endereco",label:"Endereço",align:"left",field:"endereco",sortable:!0},{name:"cep",label:"CEP",align:"left",field:"cep",sortable:!0},{name:"uf",label:"UF",align:"left",field:"uf",sortable:!0},{name:"remover",label:"Remover",align:"center",field:"remover",required:!0}]}},validations:{rotaEndereco:{endereco:{required:j["required"]}}},methods:{reset:function(){this.$v.rotaEndereco.$reset(),this.rotaEndereco=new F["a"],this.rotaEndereco.rota=this.rota,this.botaoSalvarAlterar="Gravar"},carrega:function(e){var o=this;console.log("vou carregar o rotaEndereco"),this.$q.loading.show({message:"Localizando o registro",messageColor:"white",spinnerSize:250,spinnerColor:"white"}),K.seleciona({rotaEndereco:e,rota:this.rota}).then((function(e){o.$q.loading.hide(),console.log("peguei o rotaEndereco com sucesso"),o.rotaEndereco=Object.assign({},o.rotaEndereco,e.data),o.botaoSalvarAlterar="Alterar",o.confereExcluir()}))},salvarAlterar:function(){var e=this;this.rotaEndereco.rota=this.rota,this.$q.loading.show({message:"Processando sua requisição",messageColor:"white",spinnerSize:250,spinnerColor:"white"}),clearTimeout(I),I=setTimeout((function(){if(e.$v.rotaEndereco.$touch(),e.$v.rotaEndereco.$error)return e.$q.loading.hide(),void e.$q.dialog({title:"Atenção",message:"Alguns campos precisam ser corrigidos."});!e.rotaEndereco.rotaEndereco&&e.possoGravarRotaEndereco?K.grava(e.rotaEndereco).then((function(o){e.$q.loading.hide(),console.log("rotaEndereco criado com sucesso"),e.rotaEndereco.rotaEndereco=o.data.rotaEndereco,e.rotaEndereco.usuarioCriador=o.data.usuarioCriador,e.$q.notify({type:"positive",message:"RotaEndereco criado com sucesso.",timeout:5e3});var t=e.optionsEndereco.filter((function(o){return o.value===e.rotaEndereco.endereco}));e.listaDeRotaEnderecos.push({id:e.rotaEndereco.rotaEndereco,endereco:t}),console.log(o.data),e.preencheListaTabela(o.data.rota.lista)})):N["a"].semPermissao()}),2e3)},excluir:function(e){var o=this;console.log(e),this.possoExcluirRotaEndereco?this.$q.dialog({title:"Tem certeza?",message:"Ao confirmar esta operação, não poderá desfazer.",ok:"Sim, excluir",cancel:"Cancelar"}).onOk((function(){o.$q.loading.show({message:"Processando sua requisição",messageColor:"white",spinnerSize:250,spinnerColor:"white"}),K.apaga({rotaEndereco:e,rota:o.rota}).then((function(t){o.$q.loading.hide(),console.log("rotaEndereco removido com sucesso"),o.$q.notify({type:"negative",message:"RotaEndereco removido com sucesso.",timeout:5e3});var r=o.listaDeRotaEnderecos.filter((function(o){return o.id===e}));o.listaDeRotaEnderecos.splice(o.listaDeRotaEnderecos.indexOf(r[0]),1),o.reset()}))})):N["a"].semPermissao()},listaEnderecos:function(e){var o=this;this.carregandoLista=!0,K.lista(e).then((function(e){o.carregandoLista=!1,console.log("carreguei a lista de rotaEnderecos"),o.preencheListaTabela(e.data.registros)}))},preencheListaTabela:function(e){var o=[];e.forEach((function(e){o.push({id:e.rotaEndereco,codigo:e.codigo,descricao:e.descricao,logradouro:e.logradouro,cidade:e.cidade,cep:e.cep,uf:e.uf})})),this.listaDeRotaEnderecos=o}},props:["rota"],computed:{possoGravarRotaEndereco:function(){return B["a"].gravar("rotaEndereco")},possoAbrirRotaEndereco:function(){return B["a"].abrir("rotaEndereco")},possoExcluirRotaEndereco:function(){return B["a"].excluir("rotaEndereco")}},mounted:function(){var e=this;console.log("vou carregar a rotaEndereco"),this.listaEnderecos(this.rota),this.optionsLoading=!0,K.getOptions().then((function(o){e.optionsLoading=!1,e.optionsEndereco=e.rotaEndereco.setOptions(o.data.endereco)}))}},X=W,Y=Object(L["a"])(X,T,G,!1,null,null,null),Z=Y.exports,ee=t("b673"),oe={name:"Rota",components:{ListaDeRegistros:P,formRotaEndereco:Z,BodyTabs:s["a"]},directives:{mask:V["mask"]},data:function(){return{rota:new z["a"],errorCodigo:"Preencha o código do grupo",errorDescricao:"Preencha a descrição do grupo",permissoes:[],possoAlterarRota:!1,possoExcluirRota:!1,selectedTab:"tab-1",timer:""}},validations:{rota:{descricao:{required:j["required"]},codigo:{required:j["required"],isUnique:function(e){var o=this,t=e;if(""===t)return!0;var r="gravar",a="";this.rota.rota&&(r="alterar",a=this.rota.rota);var s=Object(ee["a"])("rotas","codigo",r,a,"rota",t).then((function(e){if(200===e.status)return!0===e.data.resposta||(o.errorDescricao="Esta descrição ja está em, escolha outra",!1)}));return s}}},rotaEndereco:{nomeCompleto:{required:j["required"]},cargo:{required:j["required"]}}},methods:{reset:function(){this.$v.rota.$reset(),this.rota=new z["a"],this.$router.push({name:"rota"}),this.possoAlterarRota=!1,this.possoExcluirRota=!1,this.possoAlterarRotaEndereco=!1,this.possoExcluirRotaEndereco=!1},carrega:function(e){var o=this;console.log("vou carregar a rota"),this.$q.loading.show({message:"Localizando o registro",messageColor:"white",spinnerSize:250,spinnerColor:"white"}),k.seleciona(e).then((function(t){o.$q.loading.hide(),console.log("peguei o rota com sucesso"),o.rota=Object.assign({},o.rota,t.data),o.confereAlterarExcluir(),o.selectedTab="tab-1",o.$refs.formRotaEndereco&&o.$refs.formRotaEndereco.listaEnderecos(e)}))},salvarAlterar:function(){var e=this;this.$q.loading.show({message:"Processando sua requisição",messageColor:"white",spinnerSize:250,spinnerColor:"white"}),clearTimeout(this.timer),this.timer=setTimeout((function(){if(e.$v.rota.$touch(),e.$v.rota.$error)return e.$q.loading.hide(),void e.$q.dialog({title:"Atenção",message:"Alguns campos precisam ser corrigidos."});e.rota.rota&&e.possoAlterarRota?(console.log("estou alterando o form"),k.altera(e.rota).then((function(o){e.$q.loading.hide(),console.log("rota alterado com sucesso"),e.$root.$emit("alteraUnicoRegistro",e.rota),e.$q.notify({type:"positive",message:"Rota alterado com sucesso.",timeout:5e3})}))):!e.rota.rota&&e.possoGravarRota?k.grava(e.rota).then((function(o){console.log("rota criado com sucesso"),e.rota.rota=o.data.rota.rota,e.rota.usuarioCriador=o.data.rota.usuarioCriador,e.$router.push("/rotas/rota/"+o.data.rota.rota),e.$q.notify({type:"positive",message:"Rota criado com sucesso.",timeout:5e3}),e.$root.$emit("adicionaRegistroNaLista",e.rota),e.confereAlterarExcluir()})):N["a"].semPermissao()}),2e3)},excluir:function(){var e=this;this.possoExcluirRota?this.$q.dialog({title:"Tem certeza?",message:"Ao confirmar esta operação, não poderá desfazer.",ok:"Sim, excluir",cancel:"Cancelar"}).onOk((function(){e.$q.loading.show({message:"Processando sua requisição",messageColor:"white",spinnerSize:250,spinnerColor:"white"}),k.apaga(e.rota.rota).then((function(o){e.$q.loading.hide(),console.log("rota removido com sucesso"),e.$q.notify({type:"negative",message:"Rota removido com sucesso.",timeout:5e3}),e.$root.$emit("removeRegistro",e.rota.rota),e.reset()}))})):N["a"].semPermissao()},confereAlterarExcluir:function(){this.possoAlterarRota=B["a"].alterar("rota",this.rota.usuarioCriador),this.possoExcluirRota=B["a"].excluir("rota",this.rota.usuarioCriador)}},computed:{possoGravarRota:function(){return B["a"].gravar("rota")},possoAbrirRotaEndereco:function(){return B["a"].abrir("rotaEndereco")}},props:{id:{}},watch:{"$route.params.id":{handler:function(e){e&&this.carrega(e)},deep:!0,immediate:!0}}},te=oe,re=Object(L["a"])(te,r,a,!1,null,null,null);o["default"]=re.exports}}]);